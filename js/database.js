var database = {
    sp001: {
      name: "Áo T-Shirt Paradox Boxy Lonely Đen",
      color: "ĐEN",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 199000,
      photo: "img/product/boxy-paradox-lonely-den.webp",
      detail_photo: "img/detail_product/boxy-paradox-lonely-den.png",
      gender: "Unisex",
      size: {
        S: 15 /*Số lượng hàng có size S còn trong kho*/,
        M: 5,
        L: 10,
        XL: 3,
      },
      type: "T-Shirt",
      detail_product: "ctiet1.html",
    },
    sp002: {
      name: "Áo T-Shirt Degrey Bio logo is US",
      color: "ĐEN",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 249000,
      photo: "img/product/degrey-biglogo-is-us.webp",
      detail_photo: "img/detail_product/size.png",
      gender: "Unisex",
      size: {
        S: 8 /*Số lượng hàng có size S còn trong kho*/,
        M: 42,
        L: 11,
      },
      type: "T-Shirt",
      detail_product: "ctiet2.html",
    },
    sp003: {
      name: "Áo Degrey dây rút đen",
      color: "ĐEN",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 300000,
      photo: "img/product/degrey-dayrutden.webp",
      detail_photo: "img/detail_product/degrey-dayrutden.png",
      gender: "Unisex",
      size: {
        S: 35 /*Số lượng hàng có size S còn trong kho*/,
        M: 25,
        L: 19,
      },
      type: "T-Shirt",
      detail_product: "ctiet3.html",
    },
    sp004: {
      name: "Áo Degrey dây rút kem",
      color: "KEM",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 300000,
      photo: "img/product/degrey-dayrutkem.webp",
      detail_photo: "img/detail_product/degrey-dayrutkem.png",
      gender: "Unisex",
      size: {
        S: 35 /*Số lượng hàng có size S còn trong kho*/,
        M: 25,
        L: 19,
      },
      type: "T-Shirt",
      detail_product: "ctiet4.html",
    },
    sp005: {
      name: "Áo 3 lỗ Degrey Madmonks",
      color: "ĐEN",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 149000,
      photo: "img/product/degrey-madmonks.webp",
      detail_photo: "img/detail_product/degrey-madmonks.png",
      gender: "Female",
      size: {
        S: 33 /*Số lượng hàng có size S còn trong kho*/,
        M: 23,
        L: 39,
      },
      type: "Tank Top",
      detail_product: "ctiet5.html",
    },
    sp006: {
      name: "Hoodie Davies DSS Jacket Basic",
      color: "HỒNG",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 349000,
      photo: "img/product/dss-jacket-basic.webp",
      detail_photo: "img/detail_product/dss-jacket-basic.webp",
      gender: "Unisex",
      size: {
        S: 100 /*Số lượng hàng có size S còn trong kho*/,
        M: 76,
        L: 23,
      },
      type: "Hoodie",
      detail_product: "ctiet6.html",
    },
    sp007: {
      name: "Áo T-Shirt Davies DSS Ignore",
      color: "TRẮNG",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 99000,
      photo: "img/product/dss-shirt-ignore.webp",
      detail_photo: "img/detail_product/dss-shirt-ignore.webp",
      gender: "Female",
      size: {
        M: 38 /*Số lượng hàng có size S còn trong kho*/,
        L: 22,
        XL: 10,
      },
      type: "T-Shirt",
      detail_product: "ctiet7.html",
    },
    sp008: {
      name: "Váy Davies Skirt D Buckle",
      color: "ĐEN",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 149000,
      photo: "img/product/dss-skirt-d-buckle.webp",
      detail_photo: "img/detail_product/dss-skirt-d-buckle.webp",
      gender: "Female",
      size: {
        S: 65 /*Số lượng hàng có size S còn trong kho*/,
        M: 52,
        L: 13,
      },
      type: "Skirt",
      detail_product: "ctiet8.html",
    },
    sp009: {
      name: "Áo nỉ Davies DSS Sweater Hype Devil",
      color: "ĐEN",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 199000,
      photo: "img/product/dss-sweater-hype-devil.webp",
      detail_photo: "img/detail_product/dss-sweater-hype-devil.webp",
      gender: "Unisex",
      size: {
        M: 97 /*Số lượng hàng có size S còn trong kho*/,
        L: 188,
        XL: 99,
      },
      type: "Sweater",
      detail_product: "ctiet9.html",
    },
    sp010: {
      name: "Áo nỉ Davies DSS sweater Pink logo",
      color: "TRẮNG",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 199000,
      photo: "img/product/dss-sweater-pink-logo.webp",
      detail_photo: "img/detail_product/dss-sweater-pink-logo.webp",
      gender: "Unisex",
      size: {
        M: 97 /*Số lượng hàng có size S còn trong kho*/,
        L: 188,
        XL: 99,
      },
      type: "Sweater",
      detail_product: "ctiet10.html",
    },
    sp011: {
      name: "Hoodie Davies DSS D Entertainment",
      color: "ĐEN",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 249000,
      photo: "img/product/dsw-d-entertainment.webp",
      detail_photo: "img/detail_product/dsw-d-entertainment.webp",
      gender: "Unisex",
      size: {
        M: 97 /*Số lượng hàng có size S còn trong kho*/,
        L: 188,
        XL: 99,
      },
      type: "Hoodie",
      detail_product: "ctiet11.html",
    },
    sp012: {
      name: "Áo T-Shirt Davies DSW Dragonball",
      color: "ĐEN",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 129000,
      photo: "img/product/dsw-dragonball.webp",
      detail_photo: "img/detail_product/dsw-dragonball.webp",
      gender: "Unisex",
      size: {
        M: 20 /*Số lượng hàng có size S còn trong kho*/,
        L: 20,
        XL: 20,
      },
      type: "T-Shirt",
      detail_product: "ctiet12.html",
    },
    sp013: {
      name: "Áo Hoodie Davies DSW Old Skull",
      color: "ĐEN",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 199000,
      photo: "img/product/dsw-hoodie-oldskull.webp",
      detail_photo: "img/detail_product/dsw-hoodie-oldskull.webp",
      gender: "Male",
      size: {
        M: 20 /*Số lượng hàng có size S còn trong kho*/,
        L: 20,
        XL: 20,
      },
      type: "Hoodie",
      detail_product: "ctiet13.html",
    },
    sp014: {
      name: "Áo Hoodie Davies DSW Reboot",
      color: "ĐEN",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 249000,
      photo: "img/product/dsw-hoodie-reboot.webp",
      detail_photo: "img/detail_product/dsw-hoodie-reboot.webp",
      gender: "Unisex",
      size: {
        S: 20 /*Số lượng hàng có size S còn trong kho*/,
        M: 20,
        L: 20,
      },
      type: "Hoodie",
      detail_product: "ctiet14.html",
    },
    sp015: {
      name: "Áo Khoác Davies DSW Jacket Dust",
      color: "ĐEN",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 249000,
      photo: "img/product/dsw-jacket-dust.webp",
      detail_photo: "img/detail_product/dsw-jacket-dust.webp",
      gender: "Unisex",
      size: {
        M: 20 /*Số lượng hàng có size S còn trong kho*/,
        L: 20,
        XL: 20,
      },
      type: "Jacket",
      detail_product: "ctiet15.html",
    },
    sp016: {
      name: "Áo Khoác Davies Jacket Weapon",
      color: "ĐEN",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 219000,
      photo: "img/product/dsw-jacket-weapon.webp",
      detail_photo: "img/detail_product/dsw-jacket-weapon.webp",
      gender: "Unisex",
      size: {
        M: 20 /*Số lượng hàng có size S còn trong kho*/,
        L: 20,
        XL: 20,
      },
      type: "Jacket",
      detail_product: "ctiet16.html",
    },
    sp017: {
      name: "Áo T-Shirt Davies DSW Agression",
      color: "ĐEN",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 99000,
      photo: "img/product/dsw-shirt-aggression.webp",
      detail_photo: "img/detail_product/dsw-shirt-aggression.webp",
      gender: "Unisex",
      size: {
        M: 20 /*Số lượng hàng có size S còn trong kho*/,
        L: 20,
        XL: 20,
      },
      type: "T-Shirt",
      detail_product: "ctiet17.html",
    },
    sp018: {
      name: "Áo Hoodie Degrey Is US Kem",
      color: "KEM",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 289000,
      photo: "img/product/hoodie-degrey-is-us-kem.webp",
      detail_photo: "img/detail_product/hoodie-degrey-is-us-kem.webp",
      gender: "Unisex",
      size: {
        S: 20 /*Số lượng hàng có size S còn trong kho*/,
        M: 20,
        L: 20,
      },
      type: "Hoodie",
      detail_product: "ctiet18.html",
    },
    sp019: {
      name: "Áo Hoodie Degrey Is US",
      color: "ĐEN",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 299000,
      photo: "img/product/hoodie-degrey-is-us.webp",
      detail_photo: "img/detail_product/hoodie-degrey-is-us.webp",
      gender: "Unisex",
      size: {
        S: 20 /*Số lượng hàng có size S còn trong kho*/,
        M: 20,
        L: 20,
      },
      type: "Hoodie",
      detail_product: "ctiet19.html",
    },
    sp020: {
      name: "Áo Hoodie Paradox Nature",
      color: "ĐEN",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 229000,
      photo: "img/product/hoodie-paradox-nature.webp",
      detail_photo: "img/detail_product/hoodie-paradox-nature.webp",
      gender: "Unisex",
      size: {
        M: 20 /*Số lượng hàng có size S còn trong kho*/,
        L: 20,
        XL: 20,
      },
      type: "Hoodie",
      detail_product: "ctiet20.html",
    },
    sp021: {
      name: "Áo sơ mi H&M Linen pha Regular",
      color: "TRẮNG",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 299000,
      photo: "img/product/linen-pha-regular-fit.jpg",
      detail_photo: "img/detail_product/linen-pha-regular-fit.png",
      gender: "Male",
      size: {
        S: 20,
        M: 20 /*Số lượng hàng có size S còn trong kho*/,
        L: 20,
        XL: 20,
      },
      type: "Shirt",
      detail_product: "ctiet21.html",
    },
    sp022: {
      name: "Quần Short Paradox Fringy",
      color: "ĐEN",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 129000,
      photo: "img/product/paradox-fringy.webp",
      detail_photo: "img/detail_product/paradox-short.webp",
      gender: "Male",
      size: {
        S: 20,
        M: 20 /*Số lượng hàng có size S còn trong kho*/,
        L: 20,
        XL: 20,
      },
      type: "Short Pants",
      detail_product: "ctiet22.html",
    },
    sp023: {
      name: "Quần Short Paradox The Swagger",
      color: "ĐEN",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 149000,
      photo: "img/product/paradox-the-swagger.webp",
      detail_photo: "img/detail_product/paradox-short.webp",
      gender: "Male",
      size: {
        S: 20,
        M: 20 /*Số lượng hàng có size S còn trong kho*/,
        L: 20,
        XL: 20,
      },
      type: "Short Pants",
      detail_product: "ctiet23.html",
    },
    sp024: {
      name: "Quần Short Paradox Winding",
      color: "ĐEN",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 129000,
      photo: "img/product/paradox-winding.webp",
      detail_photo: "img/detail_product/paradox-short.webp",
      gender: "Male",
      size: {
        S: 20,
        M: 20 /*Số lượng hàng có size S còn trong kho*/,
        L: 20,
        XL: 20,
      },
      type: "Short Pants",
      detail_product: "ctiet24.html",
    },
    sp025: {
      name: "Áo T-Shirt Degrey Black Basic",
      color: "ĐEN",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 99000,
      photo: "img/product/tee-shirt-degrey-black.webp",
      detail_photo: "img/detail_product/tee-shirt-degrey-black.png",
      gender: "Unisex",
      size: {
        S: 20,
        M: 20 /*Số lượng hàng có size S còn trong kho*/,
        L: 20,
      },
      type: "T-Shirt",
      detail_product: "ctiet25.html",
    },
    sp026: {
      name: "Áo T-Shirt Teelab Unisex Basketball Jersy",
      color: "ĐEN",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 199000,
      photo: "img/product/teelab-unisex-basketball-jersey.webp",
      detail_photo: "img/detail_product/size.png",
      gender: "Unisex",
      size: {
        S: 20,
        M: 20 /*Số lượng hàng có size S còn trong kho*/,
        L: 20,
      },
      type: "T-Shirt",
      detail_product: "ctiet26.html",
    },
    sp027: {
      name: "Áo Hoodie Teelab Unisex Love Is In The Air",
      color: "TRẮNG",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 229000,
      photo: "img/product/teelab-unisex-loveisintheair.webp",
      detail_photo: "img/detail_product/size.png",
      gender: "Unisex",
      size: {
        S: 20,
        M: 20 /*Số lượng hàng có size S còn trong kho*/,
        L: 20,
      },
      type: "Hoodie",
      detail_product: "ctiet27.html",
    },
    sp028: {
      name: "Quần Short Teelab Unisex Pocket Basic",
      color: "ĐEN",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 229000,
      photo: "img/product/teelab-unisex-pocket-basic.webp",
      detail_photo: "img/detail_product/size.png",
      gender: "Unisex",
      size: {
        S: 20,
        M: 20 /*Số lượng hàng có size S còn trong kho*/,
        L: 20,
      },
      type: "Short Pants",
      detail_product: "ctiet28.html",
    },
    sp029: {
      name: "Áo Teelab Unisex Powerteam Worldwide",
      color: "ĐEN",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 219000,
      photo: "img/product/teelab-unisex-powerteam-worldwide.webp",
      detail_photo: "img/detail_product/size.png",
      gender: "Unisex",
      size: {
        S: 20,
        M: 20 /*Số lượng hàng có size S còn trong kho*/,
        L: 20,
      },
      type: "Polo",
      detail_product: "ctiet29.html",
    },
    sp030: {
      name: "Áo T-Shirt Teelab Unisex Rugby Sports",
      color: "ĐEN",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 199000,
      photo: "img/product/teelab-unisex-rugby-sports.webp",
      detail_photo: "img/detail_product/size.png",
      gender: "Unisex",
      size: {
        S: 20,
        M: 20 /*Số lượng hàng có size S còn trong kho*/,
        L: 20,
      },
      type: "T-Shirt",
      detail_product: "ctiet30.html",
    },
    sp031: {
      name: "Áo Polo Teelab Unisex Stripe Rugby Polo",
      color: "TRẮNG",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 195000,
      photo: "img/product/teelab-unisex-stripe-rugby-polo.webp",
      detail_photo: "img/detail_product/size.png",
      gender: "Unisex",
      size: {
        S: 20,
        M: 20 /*Số lượng hàng có size S còn trong kho*/,
        L: 20,
      },
      type: "Polo",
      detail_product: "ctiet31.html",
    },
    sp032: {
      name: "Áo Polo Teelab Unisex Studio Track Baby",
      color: "ĐEN",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 249000,
      photo: "img/product/teelab-unisex-studio-trackbaby.webp",
      detail_photo: "img/detail_product/size.png",
      gender: "Unisex",
      size: {
        S: 20,
        M: 20 /*Số lượng hàng có size S còn trong kho*/,
        L: 20,
      },
      type: "Polo",
      detail_product: "ctiet32.html",
    },
    sp033: {
      name: "Quần Baggy Teelab Unisex Worldwide Studio",
      color: "ĐEN",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 199000,
      photo: "img/product/teelab-unisex-worldwide-studio.webp",
      detail_photo: "img/detail_product/size.png",
      gender: "Unisex",
      size: {
        S: 20,
        M: 20 /*Số lượng hàng có size S còn trong kho*/,
        L: 20,
      },
      type: "Baggy Pants",
      detail_product: "ctiet33.html",
    },
    sp034: {
      name: "Áo Sơ Mi tay ngắn Teelab Graffiti",
      color: "ĐEN",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 149000,
      photo: "img/product/telab-graffiti.webp",
      detail_photo: "img/detail_product/size.png",
      gender: "Unisex",
      size: {
        S: 20,
        M: 20 /*Số lượng hàng có size S còn trong kho*/,
        L: 20,
      },
      type: "Shirt",
      detail_product: "ctiet34.html",
    },
    sp035: {
      name: "Áo Hoodie Teelab Mom's Favorite Kiddo",
      color: "TRẮNG",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 149000,
      photo: "img/product/telab-mom-favorite-kiddo.webp",
      detail_photo: "img/detail_product/size.png",
      gender: "Unisex",
      size: {
        S: 20,
        M: 20 /*Số lượng hàng có size S còn trong kho*/,
        L: 20,
      },
      type: "Hoodie",
      detail_product: "ctiet35.html",
    },
    sp036: {
      name: "Áo T-Shirt Teelab Unisex Soccer",
      color: "ĐEN",
      sale: 0 /*Số sản phẩm đã bán được*/,
      price: 149000,
      photo: "img/product/telab-unisex-soccer.webp",
      detail_photo: "img/detail_product/size.png",
      gender: "Unisex",
      size: {
        S: 20,
        M: 20 /*Số lượng hàng có size S còn trong kho*/,
        L: 20,
      },
      type: "T-Shirt",
      detail_product: "ctiet36.html",
    },
  };

const VND = new Intl.NumberFormat('vi-VN', {
    style: 'currency',
    currency: 'VND',
});
// VND.format();

// var current_cart = {
//   "sp027": {
//       "size": {
//         "L": 3,
//         "S": 10
//       },
//       "color": "Hồng"
//   },
//   "sp028": {
//     "size": {
//       "S": 5
//     },
//     "color": "Đen"
//   }
// }
// // var current_cart = {};
// localStorage.setItem("current_cart", JSON.stringify(current_cart));

var current_cart = JSON.parse(localStorage.getItem("current_cart"));

if(!current_cart) {
  localStorage.setItem("current_cart", JSON.stringify({}));
  current_cart = JSON.parse(localStorage.getItem("current_cart"));
}


var sale_off_product = {
    "discount": 0.25,
    "list_product": [
      "sp003",
      "sp004",
      "sp005",
      "sp006",
      "sp009",
      "sp011",
      "sp012",
      "sp014",
      "sp017",
      "sp019",
      "sp020",
      "sp022",
      "sp025",
      "sp029",
      "sp031",
      "sp033",
    ]
}


var auto_id_user = localStorage.getItem("auto_id_user");
if(auto_id_user) {
    auto_id_user= JSON.parse(auto_id_user);
} else {
    localStorage.setItem("auto_id_user", JSON.stringify(1));
}

auto_id_user = JSON.parse(localStorage.getItem("auto_id_user"));

var user = JSON.parse(localStorage.getItem("user"));

function id_of_user_name(username) {
    for(var id in user) {
        if(user[id].username.localeCompare(username) == 0)
            return id;
    }
}

function isExistUser(username) {
    for(var id in user)  {
        if(user[id].username.localeCompare(username) == 0)
            return true;
    }
    return false;
}

function isMatchPassword(username, password) {
    var id = id_of_user_name(username);
    if(user[id].password.localeCompare(password) == 0)
        return true;
    return false;
}

var promo_code = {
    "1": {
        "code": "ART96AK21N",
        "discount": 0.6
    },
    "102": {
        "code": "WRT75BA084F",
        "discount": 0.4
    }
}

var session = localStorage.getItem("session");
if(session) {
    session = JSON.parse(session);
} else {
    localStorage.setItem("session", JSON.stringify({
        "id_user": null,
        "apply_promo_code": false
    }));
}

session = JSON.parse(localStorage.getItem("session"));



function calc_sub_total() {
    var total = 0;
    for (var id in current_cart){
      for(size_product in current_cart[id].size) {
        var price = database[id].price * (current_cart[id].size)[size_product];
        if(sale_off_product.list_product.includes(id)){
            price = price - price*sale_off_product.discount;
        }
        total += price;
      }
    }
    return total;
}

function total_price_with_promo_code(user_discount, sub_total) {
    var amount_sales = sub_total*user_discount;
    return amount_sales;
}

function show_quantity_in_icon_cart(){
    var total = 0;
    var quantity_product_in_cart = document.querySelector(".cart-icon text");
    if(Object.keys(current_cart).length != 0) {
        for(var id in current_cart) {
            for(var size_product in current_cart[id].size){
              total += (current_cart[id].size)[size_product];
            }
        }
    }
    quantity_product_in_cart.innerHTML = total;
}
